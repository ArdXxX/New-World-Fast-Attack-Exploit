from threading import Event
from time import sleep
import pyautogui
import keyboard

hotkey = 'F4'

running = Event()
running.clear()

def handle_key_event(event):
    if event.event_type == 'down':
        if running.is_set():
            running.clear()
        else:
            running.set()

keyboard.hook_key(hotkey, handle_key_event)

while True:
    if not running.is_set():
        running.wait()  
    pyautogui.click()
    sleep(0.5)
    pyautogui.press('q')
    pyautogui.press('i')
    pyautogui.click()
    sleep(0.5)
    pyautogui.press('q')
    pyautogui.press('i')
    
     
